üìö Library Management API
FastAPI-based REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–Ω–∏–≥ –∏ –∞–≤—Ç–æ—Ä–æ–≤. –ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ—Å—Ç—å API, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, rate limiting –∏ –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å.

üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
Python 3.11+

PostgreSQL 15+

Redis 7+

Docker & Docker Compose

–£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ Docker:
Docker-compose up

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
üìò Swagger UI: http://localhost:8000/docs

API Endpoints
üìå API v1 (/api/v1/)

–ê–≤—Ç–æ—Ä—ã

GET    /api/v1/authors/           # –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤  
GET    /api/v1/authors/{id}       # –ü–æ–ª—É—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∞ –ø–æ ID  
POST   /api/v1/authors/           # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ—Ä–∞  
PUT    /api/v1/authors/{id}       # –û–±–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∞  
DELETE /api/v1/authors/{id}       # –£–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ—Ä–∞  

–ö–Ω–∏–≥–∏

GET    /api/v1/books/             # –°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π  
GET    /api/v1/books/{id}         # –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É –ø–æ ID  
POST   /api/v1/books/             # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–Ω–∏–≥—É  
PUT    /api/v1/books/{id}         # –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É  
DELETE /api/v1/books/{id}         # –£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É  

üìå API v2 (/api/v2/)
–í—Å–µ endpoints –∏–∑ v1 –ø–ª—é—Å:
–ö–Ω–∏–≥–∏ (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ)

GET    /api/v2/books/             # + —Ñ–∏–ª—å—Ç—Ä –ø–æ is_available  
PATCH  /api/v2/books/{id}/availability # –ò–∑–º–µ–Ω–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–Ω–∏–≥–∏  
–ù–æ–≤–æ–µ –≤ v2:

–ü–æ–ª–µ is_available –¥–ª—è –∫–Ω–∏–≥

–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

–û—Ç–¥–µ–ª—å–Ω—ã–π endpoint –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é

API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ API –∫–ª—é—á—É:

curl -H "Authorization: Bearer your-api-key"

üîÑ –ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
–î–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π POST –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:

curl -X POST \
  -H "Idempotency-Key: unique-request-123" \
  -H "Authorization: Bearer your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"name": "–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π", "nationality": "–†—É—Å—Å–∫–∏–π"}' \
  http://localhost:8000/api/v1/authors/  
–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º –∂–µ Idempotency-Key –≤–µ—Ä–Ω–µ—Ç —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–∞.

Rate Limiting
API –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤:

–õ–∏–º–∏—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:
GET –∑–∞–ø—Ä–æ—Å—ã: 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

POST –∑–∞–ø—Ä–æ—Å—ã: 30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

PUT/PATCH –∑–∞–ø—Ä–æ—Å—ã: 60 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

DELETE –∑–∞–ø—Ä–æ—Å—ã: 30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É

üìä –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
–ê–≤—Ç–æ—Ä (Author)

{  
  "id": 1,  
  "name": "–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π",  
  "bio": "–†—É—Å—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å...",  
  "birth_date": "1828-09-09",  
  "nationality": "–†—É—Å—Å–∫–∏–π",  
  "created_at": "2024-01-01T12:00:00Z",  
  "updated_at": "2024-01-01T12:00:00Z",  
  "books_count": 10  
}  
–ö–Ω–∏–≥–∞ (Book) - v1

{
  "id": 1,  
  "title": "–í–æ–π–Ω–∞ –∏ –º–∏—Ä",  
  "isbn": "9785171201234",  
  "description": "–†–æ–º–∞–Ω-—ç–ø–æ–ø–µ—è...",  
  "year_published": 1869,  
  "publisher": "–†—É—Å—Å–∫–∏–π –≤–µ—Å—Ç–Ω–∏–∫",  
  "pages": 1225,  
  "language": "ru",  
  "author_id": 1,  
  "created_at": "2024-01-01T12:00:00Z",  
  "updated_at": "2024-01-01T12:00:00Z"  
}  
–ö–Ω–∏–≥–∞ (Book) - v2 (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ)

{  
  ... –≤—Å–µ –ø–æ–ª—è –∏–∑ v1 ...  
  "is_available": true  # –ù–æ–≤–æ–µ –ø–æ–ª–µ –≤ v2  
}  

–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–≤–≤–µ–¥–µ–Ω–∏–π:
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è sqlalchemy_to_dict - —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π –∏–∑ SQLAlchemy –º–æ–¥–µ–ª–µ–π

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–∏ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è .append() –≤–º–µ—Å—Ç–æ += –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–≤–∞—Ä–µ–π –≤ —Å–ø–∏—Å–æ–∫

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä fields –≤ query string

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π:
–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã:

–î–ª—è –∞–≤—Ç–æ—Ä–æ–≤:

–¢–æ–ª—å–∫–æ ID –∏ –∏–º–µ–Ω–∞  
GET /api/v1/authors/?fields=id,name

–¢–æ–ª—å–∫–æ –∏–º–µ–Ω–∞  
GET /api/v1/authors/?fields=name

ID, –∏–º—è –∏ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å  
GET /api/v1/authors/?fields=id,name,nationality

–° –∞–≤—Ç–æ—Ä–æ–º –∫–Ω–∏–≥–∏ (–≤–ª–æ–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—è)  
GET /api/v1/books/?fields=id,title,author.name  
–î–ª—è –∫–Ω–∏–≥:

–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è  
GET /api/v1/books/?fields=id,title,isbn

–° –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é (v2)  
GET /api/v2/books/?fields=id,title,is_available

–° –∞–≤—Ç–æ—Ä–æ–º  
GET /api/v1/books/?fields=id,title,author.name,author.nationality  
–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ API:
–¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ API –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å –ø—Ä–æ—Å—Ç–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π:

bash
–ü–æ–¥—Ä–æ–±–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
GET /internal/health/detailed?token=internal-secret-token  

–ú–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
GET /internal/metrics/usage?token=internal-secret-token  

–°–µ—Ä–≤–∏—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
POST /internal/maintenance/cleanup?token=internal-secret-token&days_old=30  

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
–ì–∏–±–∫–æ—Å—Ç—å API - –∫–ª–∏–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ - —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ—Ç–≤–µ—Ç–æ–≤

–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ - –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏

–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å - –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è